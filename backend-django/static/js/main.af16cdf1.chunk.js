(this["webpackJsonpfrontend-react"]=this["webpackJsonpfrontend-react"]||[]).push([[0],{82:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),s=n(18),r=n.n(s),o=n(0),i=n(3),l=n(2),d=n.n(l);function m(e){return Object(o.jsx)("div",{style:{float:"right"},children:Object(o.jsxs)("select",{className:"form-control",id:"video-speed",onChange:function(e){e.preventDefault();var t=d()("#video-speed :selected").text();document.querySelector("#my-video").playbackRate=parseFloat(t.substring(1))},style:{width:100},children:[Object(o.jsx)("option",{selected:!0,hidden:!0,children:"Speed"}),Object(o.jsx)("option",{children:"x0.25"}),Object(o.jsx)("option",{children:"x0.5"}),Object(o.jsx)("option",{children:"x0.75"}),Object(o.jsx)("option",{children:"x1"}),Object(o.jsx)("option",{children:"x1.25"}),Object(o.jsx)("option",{children:"x1.5"}),Object(o.jsx)("option",{children:"x1.75"}),Object(o.jsx)("option",{children:"x2"})]})})}var u=function(e){var t=e.setDisplayChat,n=e.stream;return Object(o.jsxs)("div",{className:"row",style:{marginLeft:25},children:[Object(o.jsxs)("div",{style:{flex:1},children:[Object(o.jsx)("video",{id:"my-video",controls:!0,autoPlay:!0,muted:"muted",className:"video",children:Object(o.jsx)("source",{src:"/static/assets/".concat(n.name,".mp4"),type:"video/mp4"})}),Object(o.jsx)(m,{})]}),Object(o.jsx)("div",{style:{marginLeft:5,marginRight:25},children:Object(o.jsx)("nav",{className:"",children:Object(o.jsx)("button",{className:"btn",onClick:function(e){e.preventDefault(),t((function(e){return!e}))},children:Object(o.jsx)("span",{className:"navbar-toggler-icon",children:Object(o.jsx)("i",{className:"fa fa-bars"})})})})})]})},j=n(24);var b=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),a=0;a<n.length;a++){var c=n[a].trim();if(c.substring(0,e.length+1)===e+"="){t=decodeURIComponent(c.substring(e.length+1));break}}return t};function p(e,t,n,a){var c=new XMLHttpRequest,s=JSON.stringify(n);c.responseType="json",c.open(e,window.location.protocol+"//"+window.location.hostname+"/api".concat(t));var r=b("csrftoken");"POST"!==e&&"DELETE"!==e||(c.setRequestHeader("Content-Type","application/json"),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.setRequestHeader("X-CSRFToken",r)),c.onload=function(){a(c.response,c.status)},c.send(s)}var h=function(e){var t=e.stream,n=e.currentUser,c=e.socket,s=e.streamRef,r=Object(a.useState)([]),l=Object(i.a)(r,2),m=l[0],u=l[1];Object(a.useEffect)((function(){console.log(t),p("GET","/messages/?action=stream&stream="+t.name,{},(function(e,t){200===t&&u(e)}))}),[t]),Object(a.useEffect)((function(){c.on("ReceiveMessage",(function(e){u((function(t){return[].concat(Object(j.a)(t),[{content:e.content}])})),d()(".message-input input").val(null),d()(".messages").animate({scrollTop:d()("#message-list")[0].scrollHeight},"fast")}))}),[c]),Object(a.useEffect)((function(){d()(".messages").animate({scrollTop:d()("#message-list")[0].scrollHeight},"fast")}),[]);var b=function(){console.log(s.current);var e=d()(".message-input input").val();if(p("POST","/messages/create/",{content:e,stream:s.current.name},(function(e,t){console.log(e)})),""===d.a.trim(e))return!1;u((function(t){return[].concat(Object(j.a)(t),[{content:e,user:n}])})),d()(".message-input input").val(null),d()(".messages").animate({scrollTop:d()("#message-list")[0].scrollHeight},"fast"),c.emit("SendMessage",{content:e,user:n,stream:s.current})};window.addEventListener("keyup",(function(e){e.stopImmediatePropagation(),13===e.which&&b()}));var h=m.map((function(e,t){var a="";return a=null!==n&&"undefined"!==typeof e.user&&e.user.username===n.username?"sent":"replies",Object(o.jsx)("li",{className:a,children:Object(o.jsx)("p",{children:e.content})},t+e.content)}));return Object(o.jsxs)("div",{children:[Object(o.jsx)("div",{id:"frame",style:{width:"auto"},children:Object(o.jsxs)("div",{className:"content",children:[Object(o.jsx)("div",{id:"message-list",className:"messages",children:Object(o.jsx)("ul",{children:h})}),null!==n&&Object(o.jsx)("div",{className:"message-input",children:Object(o.jsxs)("div",{className:"wrap",children:[Object(o.jsx)("input",{type:"text",placeholder:"Write your message...",style:{borderRadius:5}}),Object(o.jsx)("i",{className:"fa fa-paperclip attachment","aria-hidden":"true"}),Object(o.jsx)("button",{onClick:b,className:"submit",children:Object(o.jsx)("i",{className:"fa fa-paper-plane","aria-hidden":"true"})})]})})]})}),Object(o.jsx)("script",{src:"//production-assets.codepen.io/assets/common/stopExecutionOnTimeout-b2a7b3fe212eaa732349046d8416e00a9dec26eb7fd347590fbced3ab38af52e.js"}),Object(o.jsx)("script",{src:"https://code.jquery.com/jquery-2.2.4.min.js"})]})},f=n(41),O=n.n(f),x=window.location.protocol+"//"+window.location.hostname+":4001";function g(e){var t=e.displaySearch,n=e.setDisplaySearch,c=e.setStream,s=e.setTheme,r=Object(a.useState)(""),l=Object(i.a)(r,2),m=l[0],u=l[1],j=Object(a.useState)([]),b=Object(i.a)(j,2),h=b[0],f=b[1];Object(a.useEffect)((function(){p("GET","/streams/?action=filter&filter="+m,{},(function(e,t){200===t&&f(e)}))}),[m]);var O=h.map((function(e,t){return Object(o.jsx)("li",{className:"list-group-item",children:Object(o.jsx)("a",{href:"#",onClick:function(){return p("GET","/streams/?action=stream&stream="+e.name,{},(function(e,t){200===t&&c(e[0]),d()("video")[0].load()})),void n(!1)},children:e.name})},e.name+t)})),x=e.user;return Object(o.jsxs)("div",{children:[Object(o.jsxs)("nav",{className:"navbar navbar-expand-lg",children:[Object(o.jsx)("button",{className:"btn",id:"menu-toggle",onClick:function(e){e.preventDefault(),d()("#wrapper").toggleClass("toggled")},children:Object(o.jsx)("span",{className:"navbar-toggler-icon",children:Object(o.jsx)("i",{className:"fa fa-bars"})})}),Object(o.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(o.jsx)("span",{className:"navbar-toggler-icon"})}),Object(o.jsxs)("label",{className:"switch",style:{marginTop:10,marginLeft:50},children:[Object(o.jsx)("input",{onClick:function(e){s((function(e){return"light"===e?"dark":"light"}))},type:"checkbox"}),"    ",Object(o.jsx)("div",{})]}),Object(o.jsx)("i",{className:"icon-moon",style:{marginLeft:15,marginTop:3}}),Object(o.jsx)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:Object(o.jsxs)("ul",{className:"navbar-nav ml-auto mt-2 mt-lg-0",children:[Object(o.jsxs)("form",{style:{marginRight:0},className:"form-inline my-2 my-lg-0",children:[Object(o.jsx)("button",{onClick:function(){return n(!0)},className:"btn btn-outline-secondary my-2 my-sm-0",type:"button",children:"Search Streams"}),Object(o.jsx)("div",{className:"container"})]}),Object(o.jsx)("li",{className:"nav-item active",children:Object(o.jsxs)("a",{style:{marginRight:20},className:"nav-link",href:null===x?"/login/":"/logout/",children:[null===x?"Login":"Logout",Object(o.jsx)("span",{className:"sr-only",children:"(current)"})]})})]})})]}),t&&Object(o.jsx)("div",{className:"search-overlay",children:Object(o.jsx)("body",{children:Object(o.jsxs)("div",{className:"orange-search",children:[Object(o.jsx)("form",{action:"search.php",method:"post",children:Object(o.jsx)("input",{autoComplete:"off",onChange:function(e){e.preventDefault(),u(d()("#search-box").val())},id:"search-box",className:"form-control mr-sm-2",type:"search",placeholder:"Search","aria-label":"Search"})}),""!==m&&Object(o.jsx)("div",{className:"list-group",children:O})]})})})]})}function v(e){var t=e.lecture,n=e.setMainStream,c=Object(a.useState)([]),s=Object(i.a)(c,2),r=s[0],l=s[1];Object(a.useEffect)((function(){p("GET","/streams/?action=lecture&lecture="+t.name,{},(function(e,t){200===t&&l(e)}))}),[]);var m=r.map((function(e,t){return Object(o.jsx)("li",{children:Object(o.jsx)("a",{className:"accordion-list-item",onClick:function(){p("GET","/streams/?action=stream&stream="+e.name,{},(function(e,t){200===t&&n(e[0]),d()("video")[0].load()}))},href:"#",children:e.name})},e.name+t)}));return Object(o.jsxs)("div",{id:"accordion",className:"my-accordion",children:[Object(o.jsx)("a",{className:"list-group-item list-group-item-action","data-toggle":"collapse","data-parent":"#accordion",href:"#"+t.name.replaceAll(" ",""),children:t.name}),Object(o.jsx)("div",{id:t.name.replaceAll(" ",""),className:"panel-collapse collapse in",children:Object(o.jsx)("div",{className:"panel-body",children:Object(o.jsx)("ul",{className:"accordion-list",children:m})})})]})}function y(e){var t=function(e){return e<10?"0"+e:e};return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()]+", "+e.getDate()+". "+["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]+" "+e.getFullYear()+", "+t(e.getHours())+":"+t(e.getMinutes())}var N=function(e){var t=e.setTheme,n=Object(a.useState)(!0),s=Object(i.a)(n,2),r=s[0],l=s[1],m=Object(a.useState)([]),j=Object(i.a)(m,2),b=j[0],f=j[1],N=Object(a.useState)(null),k=Object(i.a)(N,2),S=k[0],w=k[1],E=Object(a.useState)(!1),T=Object(i.a)(E,2),C=T[0],D=T[1],R=Object(a.useState)(!1),F=Object(i.a)(R,2),_=F[0],L=F[1],A=c.a.useRef(_),B=function(e){A.current=e,L(e)},G=Object(a.useState)(!1),M=Object(i.a)(G,2),q=M[0],H=M[1];window.addEventListener("keydown",(function(e){console.log(1),e.stopImmediatePropagation(),27===e.which&&D(!1)})),q||H(O()(x,{transports:["websocket"]})),Object(a.useEffect)((function(){q.on("SetSocket",(function(e){p("POST","/socket/set/",{socketID:e},(function(e,t){200===t&&console.log(e)}))}))}),[]),Object(a.useEffect)((function(){q.emit("Join",_)}),[_]),Object(a.useEffect)((function(){p("GET","/users/current/",{},(function(e,t){200===t?(w(e),p("GET","/lectures/?action=all",{},(function(e,t){200===t&&f(e)}))):p("GET","/lectures/?action=all",{},(function(e,t){200===t&&f(e)}))})),p("GET","/streams/?action=all",{},(function(e,t){200===t&&B(e[0]),d()("video")[0].load()}))}),[]);var P=b.map((function(e,t){return Object(o.jsx)(v,{lecture:e,setMainStream:B},e.name+t)}));return Object(o.jsx)("div",{children:Object(o.jsxs)("div",{className:"d-flex",id:"wrapper",children:[Object(o.jsxs)("div",{className:"",id:"sidebar-wrapper",children:[Object(o.jsx)("div",{className:"sidebar-heading",style:{textAlign:"center",marginBottom:40},children:Object(o.jsx)("img",{style:{width:200},src:"/static/assets/img/tum_logo.png"})}),Object(o.jsx)("div",{className:"list-group list-group-mine list-group-flush",children:P})]}),Object(o.jsxs)("div",{id:"page-content-wrapper",children:[Object(o.jsx)(g,{setTheme:t,setStream:B,setDisplaySearch:D,displaySearch:C,user:S}),Object(o.jsxs)("div",{className:"",style:{marginTop:20,marginBottom:20,textAlign:"center"},children:[_&&Object(o.jsxs)("div",{children:[Object(o.jsx)("h2",{children:_.lecture.name}),Object(o.jsx)("p",{style:{marginBottom:0},children:_.room}),Object(o.jsx)("p",{children:_.lecture.teacher})]}),Object(o.jsxs)("p",{children:[y(new Date(_.time))," : ",_.name]})]}),Object(o.jsxs)("div",{className:"row",children:[Object(o.jsx)("div",{className:r?"col-sm-9":"",style:r?{}:{flex:1},children:Object(o.jsx)(u,{stream:_,setDisplayChat:l})}),Object(o.jsx)("div",{className:"col-sm-3",style:r?{display:"block"}:{display:"none"},children:_&&Object(o.jsx)(h,{socket:q,streamRef:A,stream:_,currentUser:S})})]})]})]})})},k=n(16),S=n(42);function w(){var e=Object(S.a)(["\n  body {\n    background: ",";\n    color: ",";\n    font-family: Tahoma, Helvetica, Arial, Roboto, sans-serif;\n    transition: all 0.50s linear;\n  }\n  .btn {\n      color: ",";\n      border-color: ",";\n  }\n  .my-accordion .list-group-item {\n      background: ",";\n      color: ",";\n  }\n  .fa-bars {\n      color: ",";\n  }\n  .fa-paperclip {\n      color: ",";\n  }\n  .nav-link {\n      color: ","\n  }\n  #frame {\n      background: ",";\n  }\n  "]);return w=function(){return e},e}var E=Object(k.b)(w(),(function(e){return e.theme.body}),(function(e){return e.theme.text}),(function(e){return e.theme.button_color}),(function(e){return e.theme.button_border}),(function(e){return e.theme.accordion_background}),(function(e){return e.theme.text}),(function(e){return e.theme.button_color}),(function(e){return e.theme.button_color}),(function(e){return e.theme.button_color}),(function(e){return e.theme.accordion_background})),T={body:"#FFF",text:"#363537",toggleBorder:"#FFF",background:"#363537",button_border:"#363537",button_color:"#363537",accordion_background:"#EEE"},C={body:"#363537",text:"#FAFAFA",toggleBorder:"#6B8096",background:"#999",button_border:"#BDB9A6",button_color:"#BDB9A6",accordion_background:"#555"};var D=function(e){var t=Object(a.useState)("light"),n=Object(i.a)(t,2),c=n[0],s=n[1];return Object(o.jsx)(k.a,{theme:"light"===c?T:C,children:Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(E,{}),Object(o.jsx)(N,{setTheme:s})]})})};function R(e){var t=e.entries,n=e.img_url,a=e.title,c=e.n_columns,s=t.map((function(e,t){return Object(o.jsx)(F,{apiUrl:e.apiUrl,onClick:e.onClick,displayName:e.displayName,name:e.name,description:e.description,type:e.type,entries:e.entries},t+e.name)}));if(2===c){var r=[],i=[];s.map((function(e,t){return t%2===0?r.push(e):i.push(e),0})),s=Object(o.jsxs)("div",{children:[Object(o.jsx)("div",{className:"col-sm-5",children:r}),Object(o.jsx)("div",{className:"col-sm-5",children:i})]})}return Object(o.jsxs)("div",{className:"col-sm-12",children:[n&&Object(o.jsx)("div",{className:"flash_art",children:Object(o.jsx)("img",{src:n,alt:"GATHR"})}),Object(o.jsx)("div",{className:"unterschrift",children:Object(o.jsx)("p",{children:a})}),s]})}function F(e){var t=e.name,n=e.displayName,c=e.type,s=e.required,r=e.entries,l=e.iconName,d=e.onClick,m=e.apiUrl,u=Object(o.jsx)("label",{className:"",children:n}),j=Object(o.jsx)("input",{name:t,type:c,className:"form-control"});s&&j.setAttribute("required",!0);var b=Object(a.useState)([]),h=Object(i.a)(b,2),f=h[0],O=h[1];Object(a.useEffect)((function(){"dropdown"===c&&"undefined"===typeof r?p("GET",m,{},(function(e,t){200===t&&O(e.map((function(e){return e.name})))})):"dropdown"===c&&O(r)}),[m,r,c]);var x=Object(o.jsx)("div",{});switch(c){case"dropdown":x=Object(o.jsxs)("div",{children:[u,Object(o.jsx)(_,{entries:f,name:t})]});break;case"radio":x=Object(o.jsxs)("div",{children:[j,u]});break;case"checkbox":j=Object(o.jsx)("input",{id:t,name:t,type:c,className:"form-control",onClick:d}),x=Object(o.jsxs)("div",{style:{textAlign:"center"},children:[j,u]});break;case"date":j=Object(o.jsx)("input",{name:t,type:c,className:"form-control",defaultValue:"2020-01-01"}),x=Object(o.jsxs)("div",{children:[u,j]});break;default:x=Object(o.jsxs)("div",{children:[u,j]})}return Object(o.jsxs)("div",{className:"input-group my-form-entry",children:[Object(o.jsx)("span",{className:"input-group-addon",children:l&&Object(o.jsx)("i",{className:"material-icons",children:l})}),Object(o.jsx)("div",{className:"form-group label-floating",children:x})]})}function _(e){var t=e.entries,n=e.onChangeFun,a=e.name;return t.sort(),t=t.map((function(e,t){return Object(o.jsx)("option",{value:e,children:e},e+t)})),Object(o.jsx)("div",{className:"my-form-control",children:Object(o.jsx)("select",{id:a.toLowerCase(),className:"form-control",onChange:n,children:t})})}var L=function(e){var t=Object(a.useState)(!1),n=Object(i.a)(t,2),c=n[0],s=n[1];return Object(o.jsx)("div",{className:"container",style:{marginTop:200},children:Object(o.jsxs)("form",{id:"login-form",children:[Object(o.jsx)("h1",{children:"Login"}),Object(o.jsx)(R,{entries:[{name:"username",displayName:"Username",type:"text"},{name:"password",displayName:"Password",type:"password"},{name:"sessionCookie",displayName:"Accept session cookie",type:"checkbox"}]}),Object(o.jsx)("button",{className:"btn btn-primary",type:"button",onClick:function(e){e.preventDefault();var t=document.getElementById("login-form"),n=new FormData(t),a={};n.forEach((function(e,t){a[t]=e})),console.log(a),p("POST","/login/",a,(function(e,t){200===t&&(window.location.href="/"),200!==t&&s(!0)}))},children:"Login"}),c&&Object(o.jsx)("p",{style:{color:"red"},children:"Wrong username or password."})]})})};var A=function(e){var t=e.name,n=e.formEntries,c=Object(a.useState)([]),s=Object(i.a)(c,2),r=s[0],l=s[1];Object(a.useEffect)((function(){p("GET","/"+t+"/?action=all",{},(function(e,t){200===t&&l(e)}))}),[]);var m=[{name:t,displayName:"Existing "+t,type:"dropdown",entries:r.map((function(e){return e.name}))}];return Object(o.jsxs)("div",{children:[Object(o.jsxs)("form",{id:t+"-form",children:[Object(o.jsx)("h1",{children:"Manage "+t}),Object(o.jsx)(R,{entries:n}),Object(o.jsx)("button",{className:"btn btn-primary",onClick:function(e){e.preventDefault();var a=document.getElementById(t+"-form"),c=new FormData(a),s={};c.forEach((function(e,t){s[t]=e})),"undefined"!==typeof s.time&&(""!==s.time?s.time=s.date+" "+s.time:s.time=s.date),n.forEach((function(e){"dropdown"===e.type&&(s[e.name]=d()("#"+e.name+" option:selected").val())})),delete s.date,console.log(s),p("POST","/"+t+"/create/",s,(function(e,t){}))},children:"Submit"}),Object(o.jsx)(R,{entries:m})]}),Object(o.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(e){e.preventDefault();var n=d()("#"+t+" option:selected").val();p("POST","/"+t+"/delete/",{name:n},(function(e,t){200===t&&console.log(e),200!==t&&console.log("Error deleting the object")}))},children:"Delete"})]})},B=[{name:"name",displayName:"Stream Title",type:"text"},{name:"room",displayName:"Location",type:"dropdown",entries:["Room 1","Room 2","Room 3","Room 4"]},{name:"date",displayName:"Date",type:"date"},{name:"time",displayName:"Time",type:"time"},{name:"lecture",displayName:"Lecture",type:"dropdown",apiUrl:"/lectures/?action=all"}],G=[{name:"name",displayName:"Lecture name",type:"text"},{name:"semester",displayName:"Semester",type:"dropdown",entries:["WS19/20","SS20","WS20/21"]},{name:"teacher",displayName:"Teacher",type:"text"},{name:"lecture_type",displayName:"Type",type:"dropdown",entries:["Vorlesung","\xdcbung","Tutorium"]}];var M=function(e){return Object(o.jsx)("div",{className:"container",style:{marginTop:50},children:Object(o.jsxs)("div",{className:"row",children:[Object(o.jsx)("div",{className:"col-sm-6",children:Object(o.jsx)(A,{name:"streams",formEntries:B})}),Object(o.jsx)("div",{className:"col-sm-6",children:Object(o.jsx)(A,{name:"lectures",formEntries:G})})]})})},q=c.a.createElement,H=document.getElementById("main-page");H&&r.a.render(q(D,H.dataset),H);var P=document.getElementById("login");P&&r.a.render(q(L,P.dataset),P);var I=document.getElementById("manage");I&&r.a.render(q(M,I.dataset),I)}},[[82,1,2]]]);
//# sourceMappingURL=main.af16cdf1.chunk.js.map